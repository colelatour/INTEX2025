<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Users - Ella Rises</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              ella: {
                'light-blue': '#99B7C6', 'purple': '#978Ec4', 'off-white': '#F9F5EA',
                'light-pink': '#FFD8D1', 'pink': '#F9AFB1', 'green': '#9AB59D',
                'dark-gray': '#3A3F3B', 'orange': '#F4B092', 'red': '#CE325B',
              }
            },
            fontFamily: {
              serif: ['"DM Serif Display"', 'serif'],
              sans: ['"Montserrat"', 'sans-serif'],
            },
            animation: { 'fade-in': 'fadeIn 0.8s ease-out forwards', },
            keyframes: {
              fadeIn: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' }, }
            }
          }
        }
      }
    </script>
    <style>
      body { background-color: #F9F5EA; font-family: 'Montserrat', sans-serif; }
    </style>
</head>

<body class="font-sans selection:bg-ella-pink selection:text-white">
    <!-- Navigation-->
    <nav class="sticky top-0 z-50 backdrop-blur-md bg-white/70 border-b border-white/20 shadow-sm">
        <div class="container mx-auto px-4 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <a href="/" class="flex items-center gap-2 group">
                    <img src="/assets/img/EllaRises.png" alt="Ella Rises Logo" class="w-12 h-12 transition-transform group-hover:scale-110" />
                    <span class="font-serif text-2xl font-bold tracking-wide text-ella-dark-gray">Ella<span class="text-ella-pink">Rises</span></span>
                </a>
                <div class="hidden lg:flex items-center gap-8">
                    <a href="/" class="text-sm tracking-widest uppercase text-ella-dark-gray hover:text-ella-pink transition-colors">Home</a>
                    <a href="/dashboard" class="text-sm tracking-widest uppercase text-ella-dark-gray hover:text-ella-pink transition-colors">Dashboard</a>
                    <a href="/#our-impact" class="text-sm tracking-widest uppercase text-ella-dark-gray hover:text-ella-pink transition-colors">Impact</a>
                </div>
                <div class="hidden lg:flex items-center gap-4">
                    <% if (user) { %>
                        <span class="text-sm font-medium text-ella-dark-gray/80">Hi, <%= user.firstName %></span>
                        <a href="/logout" class="px-4 py-1.5 text-sm rounded-xl font-semibold transition-all bg-transparent text-ella-dark-gray border-2 border-ella-dark-gray hover:bg-ella-dark-gray hover:text-white">Logout</a>
                    <% } else { %>
                        <a href="/login" class="px-6 py-2 text-sm rounded-xl font-semibold bg-ella-pink text-ella-dark-gray border-2 border-ella-pink shadow-md">Login</a>
                    <% } %>
                </div>
                <button id="mobileMenuBtn" class="lg:hidden p-2 text-ella-dark-gray"><i class="bi bi-list text-2xl" id="menuIcon"></i></button>
            </div>
        </div>
        <div id="mobileMenu" class="lg:hidden overflow-hidden transition-all duration-300 bg-white/95 backdrop-blur-xl border-t border-ella-light-pink/30 max-h-0">
            <div class="px-4 py-6 space-y-4 flex flex-col items-center">
                <a href="/" class="text-lg font-medium">Home</a>
                <a href="/dashboard" class="text-lg font-medium">Dashboard</a>
                <% if (user) { %>
                    <span class="text-sm text-gray-500">Logged in as <%= user.firstName %></span>
                    <a href="/logout" class="w-full max-w-xs text-center px-6 py-2.5 rounded-xl font-semibold bg-transparent text-ella-dark-gray border-2 border-ella-dark-gray">Logout</a>
                <% } %>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-16 animate-fade-in">
        <div class="flex flex-col md:flex-row justify-between items-end mb-8 gap-4">
            <div>
                <h1 class="font-serif text-4xl text-ella-dark-gray mb-2">Users</h1>
                <p class="text-gray-500">Manage and view users.</p>
            </div>
            <% if (user && user.role === 'manager') { %>
                <a href="/users/add" class="px-6 py-2.5 rounded-xl font-semibold transition-all bg-ella-pink text-ella-dark-gray hover:bg-white border-2 border-ella-pink shadow-lg flex items-center gap-2">
                    <i class="bi bi-plus-lg"></i> Add Participant
                </a>
            <% } %>
        </div>

        <% if (typeof message !== 'undefined' && message) { %>
            <div class="bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-xl mb-8"><%= message %></div>
        <% } %>

        <!-- Search Bar -->
        <form action="/users" method="GET" class="bg-white rounded-2xl shadow-sm p-4 mb-8 flex items-center gap-4 border border-gray-100">
            <i class="bi bi-search text-gray-400 text-xl pl-2"></i>
            <input type="search" name="search" placeholder="Search by name or email..." value="<%= searchTerm || '' %>" class="flex-grow bg-transparent border-none focus:ring-0 text-gray-700 placeholder-gray-400 font-sans outline-none"/>
            <button type="submit" class="px-6 py-2 rounded-xl font-semibold bg-ella-pink text-ella-dark-gray hover:bg-white border-2 border-ella-pink transition-all">Search</button>
        </form>

        <!-- Table Card -->
        <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100/50">
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-gradient-to-r from-ella-off-white to-white border-b border-gray-100">
                            <th class="p-6 font-serif text-ella-dark-gray font-normal text-lg">Name</th>
                            <th class="p-6 font-serif text-ella-dark-gray font-normal text-lg">Email</th>
                            <th class="p-6 font-serif text-ella-dark-gray font-normal text-lg">City</th>
                            <th class="p-6 font-serif text-ella-dark-gray font-normal text-lg">State</th>
                            <th class="p-6 font-serif text-ella-dark-gray font-normal text-lg">Interest</th>
                            <% if (user && user.role === 'manager') { %>
                            <th class="p-6 font-serif text-ella-dark-gray font-normal text-lg text-right">Actions</th>
                            <% } %>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (participants && participants.length > 0) { %>
                            <% participants.forEach(function(p) { %>
                                <tr class="group hover:bg-gray-50 transition-colors border-b border-gray-50 last:border-none">
                                    <td class="p-6">
                                        <div class="font-bold text-gray-800"><%= p.participantfirstname %> <%= p.participantlastname %></div>
                                    </td>
                                    <td class="p-6 text-gray-600"><%= p.participantemail %></td>
                                    <td class="p-6"><span class="px-3 py-1 rounded-full bg-ella-light-blue/10 text-ella-dark-gray text-xs font-semibold"><%= p.participantcity || 'N/A' %></span></td>
                                    <td class="p-6 text-gray-600"><%= p.participantstate || 'N/A' %></td>
                                    <td class="p-6 text-gray-600"><%= p.participantfieldofinterest || 'N/A' %></td>
                                    <% if (user && user.role === 'manager') { %>
                                    <td class="p-6 text-right">
                                        <div class="flex justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                            <form action="/users/edit/<%= p.participantid %>" method="GET" class="inline">
                                                <button type="submit" class="p-2 h-10 w-10 rounded-full border-2 border-ella-dark-gray text-ella-dark-gray hover:bg-ella-dark-gray hover:text-white transition-all">
                                                    <i class="bi bi-pencil-fill"></i>
                                                </button>
                                            </form>
                                            <form action="/users/delete/<%= p.participantid %>" method="POST" class="inline" onsubmit="return confirm('Are you sure?');">
                                                <button type="submit" class="p-2 h-10 w-10 rounded-full border-2 border-ella-red text-ella-red hover:bg-ella-red hover:text-white transition-all">
                                                    <i class="bi bi-trash-fill"></i>
                                                </button>
                                            </form>
                                        </div>
                                    </td>
                                    <% } %>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="<%= (user && user.role === 'manager') ? '6' : '5' %>" class="p-12 text-center text-gray-400">
                                    <i class="bi bi-inbox text-4xl mb-4 block"></i>
                                    No participants found.
                                </td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Pagination -->
        <% if (totalPages > 1) { %>
        <div class="flex justify-center mt-8 gap-2">
            <a href="/users?page=<%= Math.max(1, currentPage - 1) %><%= searchTerm ? '&search=' + searchTerm : '' %>" class="w-10 h-10 rounded-full bg-white shadow flex items-center justify-center <%= currentPage === 1 ? 'opacity-50 pointer-events-none' : 'hover:bg-ella-pink hover:text-white' %> transition-colors">
                <i class="bi bi-chevron-left"></i>
            </a>
            <% for(let i = 1; i <= totalPages; i++) { %>
                <a href="/users?page=<%= i %><%= searchTerm ? '&search=' + searchTerm : '' %>" class="w-10 h-10 rounded-full shadow flex items-center justify-center transition-colors font-bold <%= currentPage === i ? 'bg-ella-pink text-white' : 'bg-white text-gray-600 hover:bg-gray-50' %>">
                    <%= i %>
                </a>
            <% } %>
            <a href="/users?page=<%= Math.min(totalPages, currentPage + 1) %><%= searchTerm ? '&search=' + searchTerm : '' %>" class="w-10 h-10 rounded-full bg-white shadow flex items-center justify-center <%= currentPage === totalPages ? 'opacity-50 pointer-events-none' : 'hover:bg-ella-pink hover:text-white' %> transition-colors">
                <i class="bi bi-chevron-right"></i>
            </a>
        </div>
        <% } %>
    </div>

    <!-- Footer-->
    <footer class="bg-ella-dark-gray text-white pt-16 pb-8 relative overflow-hidden mt-12">
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-ella-light-blue via-ella-pink to-ella-purple"></div>
        <div class="container mx-auto px-4 text-center">
            <div class="flex flex-col md:flex-row justify-between items-center mb-12 gap-6">
                <div class="text-left">
                    <h3 class="font-serif text-2xl mb-2 text-ella-pink">Ella Rises</h3>
                    <p class="text-gray-400 max-w-xs text-sm">Empowering young Hispanic women through education, culture, and community.</p>
                </div>
                <div class="flex gap-8">
                    <a href="https://www.facebook.com/share/1ALmigc75W/?mibextid=wwXIfr" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-ella-pink transition-all"><i class="bi bi-facebook"></i></a>
                    <a href="https://www.instagram.com/ellarises?igsh=YTVtZzBrbDJ0eTBx" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-ella-pink transition-all"><i class="bi bi-instagram"></i></a>
                </div>
            </div>
            <div class="border-t border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center text-sm text-gray-400">
                <p>&copy; 2025 Ella Rises. All Rights Reserved.</p>
                <div class="flex gap-6 mt-4 md:mt-0">
                    <a href="https://www.ellarises.org/team" class="hover:text-white transition-colors">About</a>
                    <a href="https://www.ellarises.org/contact-us" class="hover:text-white transition-colors">Contact</a>
                    <a href="/teapot" class="hover:text-white transition-colors">Teapot</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const menuIcon = document.getElementById('menuIcon');
        
        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', () => {
                const isOpen = mobileMenu.style.maxHeight && mobileMenu.style.maxHeight !== '0px';
                mobileMenu.style.maxHeight = isOpen ? '0' : '400px';
                menuIcon.classList.toggle('bi-list');
                menuIcon.classList.toggle('bi-x-lg');
            });
        }
    </script>
</body>
</html>

